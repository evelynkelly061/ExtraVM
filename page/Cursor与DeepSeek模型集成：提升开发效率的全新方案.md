# Cursor与DeepSeek模型集成：提升开发效率的全新方案

在编程和代码开发过程中，AI代码编辑器Cursor以其强大的辅助功能和便利性，受到了众多开发者的青睐。然而，Cursor的PRO版本才能享受全部功能，这对不少开发者来说是一笔不小的开销。幸运的是，Cursor支持使用其他大模型的API，比如国内优秀的DeepSeek模型，这为开发者提供了一种更具经济性和灵活性的选择。本文将详细介绍如何将Cursor的模型替换为DeepSeek模型，从而提升开发效率。

👉 [WildCard | 一分钟注册，轻松订阅海外线上服务](https://bbtdd.com/WildCard)

## 为什么选择DeepSeek模型？

Cursor虽然提供14天的免费试用期，但之后可能会限制速度。这对于需要频繁使用代码编辑器的开发者来说，显然是不够的。而DeepSeek模型不仅使用成本低廉，而且准确度非常高，性价比极高。

DeepSeek-V3是一款拥有6710亿总参数的混合专家语言模型，通过多项创新技术，显著提升了模型的性能与效率。其支持多令牌预测和FP8训练，降低了内存消耗和训练成本，同时保持了数值稳定性。DeepSeek模型在数学、编程和多语言任务中表现卓越，非常适合用于代码生成和编程辅助。

### 模型参数与训练

- **参数量**：DeepSeek V3拥有6710亿（671B）参数，在推理过程中激活约370亿参数。
- **训练数据**：在14.8万亿个token上进行了预训练。
- **训练效率**：其训练过程高效，总训练成本为278.8万H800GPU小时，训练成本为557.6万美元（约合4070万人民币）。相比之下，Llama 3 405B的训练时长是3080万GPU小时，训练一个7B的Llama 2也要花费76万美元（约合555万人民币）。DeepSeek V3的训练消耗的算力仅为Llama 3 405B的1/11，让在有限算力预算上进行模型预训练这件事变得容易。

### 技术创新

- **基础架构**：DeepSeek V3的基础架构仍在Transformer架构内，同时采用了多头潜在注意力（MLA）和DeepSeekMOE（DeepSeek混合专家）机制，以实现更高效推理和更具经济性价比的训练。
- **新策略引入**：DeepSeek V3创新性地引入了无辅助损失的负载均衡策略（auxiliary-loss-free load balancing strategy）和多token预测策略（MTP），对模型训练过程进行了优化。
- **后训练优化**：结合了监督微调（SFT）和强化学习（RL），使模型可以更好地与人类偏好对齐，增强泛化能力，并更好地处理未见过的数据和任务。
- **FP8混合精度训练**：DeepSeek V3首次在超大规模模型上验证了FP8训练的可行性和有效性。

#### FP8格式介绍

FP8混合精度训练是一种在深度学习模型训练过程中使用FP8（8位浮点数）格式进行部分或全部计算的技术。以下是对FP8混合精度训练的详细解释：

- **E4M3**：包含4个指数位和3个尾数位，这种格式提供了更高的精度，适合用于前向传播（Forward）计算。
- **E5M2**：包含5个指数位和2个尾数位，这种格式提供了更广的动态范围，更适合用于反向传播（Backward）计算。

#### FP8混合精度训练的优势

1. **减少内存占用**：FP8格式显著减少了内存占用，使得在有限的硬件资源下能够处理更大的模型或更大的批量大小。
2. **提升计算性能**：由于内存占用减少，FP8混合精度训练允许更多的数据并行处理，从而提高了计算速度。
3. **降低训练成本**：通过减少内存使用和计算时间，FP8混合精度训练有助于降低整体训练成本。

#### FP8混合精度训练的技术要点

1. **基于块的累加技术**：为了减小低精度数之间相加的累积误差，FP8混合精度训练通常采用基于块的累加技术。这种方法将一个很长的点乘结果进行分块累加，从而缩小了累加误差。
2. **随机舍入技术**：在某些情况下，FP8混合精度训练会采用随机舍入技术代替传统的四舍五入，以降低舍入误差。
3. **混合使用不同精度格式**：在实际应用中，FP8混合精度训练通常会与其他精度格式（如FP16或FP32）结合使用。例如，在关键操作（如权重更新）中仍使用较高精度的FP32以确保数值稳定性，而在其他操作中则使用FP8以提高计算效率。
4. **指数偏移和自动精度缩放**：为了解决FP8表示数的范围有限的问题，通常会设置指数偏移以扩展表示范围，并采用自动精度缩放技术对不同层的网络采用不同的缩放因子，以减少上溢和下溢现象。

#### FP8混合精度训练的应用与挑战

> **应用**：FP8混合精度训练已广泛应用于各种深度学习模型的训练中，包括图像识别、自然语言处理、语音识别和目标检测等领域。通过减少内存占用和提升计算性能，它有助于加速模型训练过程并降低训练成本。
>
> **挑战**：尽管FP8混合精度训练具有诸多优势，但也面临一些挑战。例如，由于精度降低，可能会导致模型收敛速度变慢或收敛到较差的局部最优解。此外，FP8混合精度训练的实现也相对复杂，需要仔细设计和调试算法以确保其稳定性和准确性。

### 性能表现

- **基准测试**：DeepSeek V3在多项基准测试中表现优异，性能比肩世界顶级模型，如GPT-4o-0513和Claude-3.5-Sonnet-1022。
- **具体评分**：使用LiveBench基准进行的全面性能评估显示，Deepseek V3的全球平均得分为60.4。在“指令遵循”方面获得80.9分；数学获得60.0分；编程获得63.4分，其表现优于包括GPT-4o-2024-05-13、o1-mini等专有模型在内的绝大多数开闭源模型。但在逻辑推理方面得分仅为50.0分，表明该模型在需要批判性思维和解决问题的任务中面临挑战。

### 应用与部署

- **API服务**：DeepSeek V3提供了API服务，定价合理，性能/价格比最优。每百万输入tokens 0.5元（缓存命中）/2元（缓存未命中），每百万输出tokens 8元。此外，DeepSeek还提供了一个45天的优惠价格体验期。
- **本地部署**：支持在多种硬件和开源社区软件上进行本地部署，包括SGLang、LMDeploy、TensorRT-LLM等框架。但全精度推理需要1.5TB内存，对硬件要求较高。

### 争议与前景

- **争议**：尽管DeepSeek V3的技术参数和成本数据看似令人信服，但其可验证性引发了广泛质疑。例如，训练成本的合理性、MoE架构实现的技术难题等。此外，部分开源社区成员对其指令遵循高分提出质疑。
- **前景**：随着更多的第三方评测和同行评议的出现，DeepSeek V3的准确评估将会逐渐明确。其开源性质和较低的使用成本可能会吸引更多用户，推动开源大模型技术的持续演进。

## 注册DeepSeek账号并获取API Key

要使用DeepSeek模型，首先需要注册一个DeepSeek账号。注册地址为[DeepSeek官网](https://platform.deepseek.com/sign_in)。新用户注册后会获得500万tokens的免费额度，可以免费使用一段时间。

注册完成后，登录DeepSeek开放平台，点击左侧的“API Keys”菜单，然后创建API Key。输入名称后，点击“创建API Key”按钮，复制生成的API Key。

## 配置Cursor使用DeepSeek模型

1. **打开Cursor设置**： 
   - 在Cursor界面，点击右上角的齿轮图标或依次点击“文件”->“首选项”->“Cursor Settings”进入设置界面。
2. **添加DeepSeek模型**： 
   - 在设置界面中，选择“Models”菜单，点击“Add Model”按钮。
   - 在输入框中输入模型名称“deepseek-coder”和“deepseek-chat”（可选），注意模型名称不能输入错误。
   - 添加好模型后，确保其处于激活状态。
3. **配置API Key和Base URL**： 
   - 在设置界面中，找到“OpenAI API Key”配置项。
   - 在第一个输入框中，输入刚刚复制的DeepSeek API Key。
   - 在第二个输入框中，输入DeepSeek的Base URL：[https://api.deepseek.com](https://api.deepseek.com)
   - 输入完成后，点击“Save”按钮，然后点击“Verify”按钮验证配置是否正确。

## 测试DeepSeek模型的使用

配置完成后，可以开始测试DeepSeek模型在Cursor中的使用情况。

1. **生成代码**： 
   - 返回到代码编辑界面，创建一个新的文件（例如snake.c）。
   - 点击设置左边的按钮，打开AI对话栏。
   - 输入描述信息，例如“生成一个贪吃蛇游戏”，然后点击“生成”按钮。
   - Cursor将自动调用DeepSeek模型，生成对应的代码。
   - 自定义模型的限制：Cursor 虽然支持自定义模型，相比于官方的模型，自定义模型有一些限制，比如无法使用 `Composer`，比如 `⌘ K` 补全功能就无法使用。迫于贫穷，只能将就一下了。
2. **查看回复情况**： 
   - 根据生成的代码，检查其是否符合预期。
   - 如果有任何问题，可以返回AI对话栏，继续输入修改建议或新的描述信息，生成更优化的代码。

## 总结

通过本文的介绍，我们详细了解了如何将Cursor的模型替换为DeepSeek模型。DeepSeek模型以其卓越的性能和低廉的使用成本，为开发者提供了一种更具经济性和灵活性的选择。配置完成后，我们可以利用DeepSeek模型在Cursor中自动生成代码，提高开发效率。

未来，随着AI技术的不断发展，相信会有更多优秀的模型涌现出来，为开发者提供更多的选择和便利。让我们一起期待更加智能、高效的编程时代的到来！